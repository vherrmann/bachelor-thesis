\usetikzlibrary{decorations.pathmorphing}

% #1 - style options
% #2 - outer radius
% #3 - inner radius
% #4 - start angle
% #5 - end angle
% #6 - shift
\newcommand{\partialDonutOutline}[6][]{
  \def\R{#2}
  \def\r{#3}
  \def\startAngle{#4}
  \def\endAngle{#5}

  \begin{scope}[shift={#6}]
    \def\capR{{(\R-\r)/2}}

    \draw[#1] (\startAngle:{(\R+\r)/2}) ++(\startAngle-180:\capR) arc (\startAngle-180:\startAngle:\capR);
    \draw[#1] (\endAngle:{(\R+\r)/2}) ++(\endAngle+180:\capR) arc (\endAngle+180:\endAngle:\capR);

    \draw[#1] (\startAngle:\R) arc (\startAngle:\endAngle:\R);
    \draw[#1] (\endAngle:\r) arc (\endAngle:\startAngle:\r);
  \end{scope}
}

% #1 - style options
% #2 - outer radius
% #3 - inner radius
% #4 - start angle
% #5 - end angle
% #6 - shift
\newcommand{\partialDonut}[6][]{
  \def\R{#2}
  \def\r{#3}
  \def\startAngle{#4}
  \def\endAngle{#5}

  \def\capRadius{(\R-\r)/2}
  \begin{scope}[shift={#6}]
    \fill[#1] (\startAngle:{(\R+\r)/2}) circle (\capRadius);
    \fill[#1] (\endAngle:{(\R+\r)/2}) circle (\capRadius);

    % Draw partial donut with rounded caps
    \fill[#1]
    (\startAngle:\R) 
    arc (\startAngle:\endAngle:\R) 
    -- (\endAngle:\r) 
    arc (\endAngle:\startAngle:\r) 
    -- cycle;
  \end{scope}
}


% #1 - style options fill
% #2 - style options outline
% #3 - outer radius
% #4 - inner radius
% #5 - start angle
% #6 - end angle
% #7 - shift
\NewDocumentCommand{\partialDonutWithOutline}{O{} O{} m m m m m}{%
    \partialDonut[#1]{#3}{#4}{#5}{#6}{#7}
    \partialDonutOutline[#2]{#3}{#4}{#5}{#6}{#7}
}

\begin{tikzpicture}[scale=1.5]
    \partialDonut[green!5]{1.7}{0.8}{0}{360}{(0.5,0.9)};
    \draw (0.5,0.9) circle (1.7);
    \draw (0.5,0.9) circle (0.8);

    \partialDonutWithOutline[blue!30]{1.5}{1}{-55}{235}{(0.5,0.9)};
    \partialDonutOutline[dashed]{1.6}{0.9}{-55}{235}{(0.5,0.9)};


    % Label the set
    \node at (1, 2) [blue] {\huge\textbf{$Î©$}};
    
    \node at (2.2, 2.3) [red] {\huge\textbf{$C$}};

    \node at (0.5, -0.25) [green] {\huge\textbf{$U$}};

    \foreach \x in {-1, -0.75, ..., 2} {
        \draw[gray, thin, dashed] (\x, -0.5) -- (\x, 2.5); % Vertical lines
    }
    \foreach \y in {-0.5, -0.25, ..., 2.5} {
        \draw[gray, thin, dashed] (-1, \y) -- (2, \y); % Horizontal lines
    }

    % Draw the boundary of the grid around the set
    \draw[thick, dashed, red] (-1, -0.5) rectangle (2, 2.5);
    %
    \draw[<->] (-1.22, 2.5) -- (-1.22, -0.5) node[midway, left] {$K$};
\end{tikzpicture}
